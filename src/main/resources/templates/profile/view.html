<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Fashion Shop</title>

    <!-- External -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;600&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Your CSS -->
    <link rel="stylesheet" th:href="@{/css/header.css}">
    <link rel="stylesheet" th:href="@{/css/footer.css}">

    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Lato',sans-serif; background:#f8f9fa; min-height:100vh; }
        .container { max-width:700px; margin:40px auto; }
        .profile-card { background:white; border-radius:20px; box-shadow:0 15px 40px rgba(0,0,0,.1); padding:40px; }
        .avatar-large { width:100px; height:100px; border-radius:50%; object-fit:cover; border:4px solid #e5e7eb; }
        .info-row { display:flex; align-items:center; margin-bottom:20px; padding-bottom:15px; border-bottom:1px solid #eee; }
        .info-row i { width:40px; color:#dc2626; font-size:18px; }
        .info-label { font-weight:600; color:#4b5563; min-width:120px; }
        .info-value { color:#1a1a1a; }
        .btn-edit { display:inline-block; padding:10px 20px; background:#dc2626; color:white; border-radius:10px; text-decoration:none; font-weight:600; }
        .btn-edit:hover { background:#b91c1c; }
    </style>
</head>

<body>

<!-- HEADER -->
<div th:replace="~{header :: header}" th:with="currentPath=${currentPath}"></div>

<div class="container">
    <div class="profile-card">
        <div style="text-align:center; margin-bottom:30px;">
            <!-- Fixed: Removed the leading slash and fixed typo -->
            <img th:if="${user?.avatarUrl != null and !#strings.isEmpty(user.avatarUrl)}"
                 th:src="@{/{url}(url=${user.avatarUrl})}"
                 alt="Avatar"
                 class="avatar-large"
                 onerror="this.src='/images/default_avatar.png'" />

            <img th:unless="${user?.avatarUrl != null and !#strings.isEmpty(user.avatarUrl)}"
                 th:src="@{/images/default_avatar.png}"
                 alt="Default Avatar"
                 class="avatar-large" />

            <h2 th:text="${user?.fullName}">User</h2>
            <p th:text="${user?.email}">email@example.com</p>
        </div>

        <div class="info-row">
            <i class="fas fa-phone"></i>
            <div>
                <div class="info-label">Phone</div>
                <div class="info-value" th:text="${user?.phone ?: 'Not set'}">Not set</div>
            </div>
        </div>

        <div class="info-row">
            <i class="fas fa-map-marker-alt"></i>
            <div>
                <div class="info-label">Address</div>
                <div class="info-value" th:text="${user?.defaultAddress ?: 'Not set'}">Not set</div>
            </div>
        </div>

        <div style="text-align:center; margin-top:30px;">
            <a th:href="@{/profile/setup}" class="btn-edit">
                Edit Profile
            </a>
        </div>

    </div>
</div>

<!-- FOOTER -->
<div th:replace="~{footer :: footer}"></div>

</body>
</html>