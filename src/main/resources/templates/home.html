<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Home</title>
</head>
<body>
<h2>Welcome!</h2>

<!-- If user is authenticated -->
<div th:if="${#authentication != null}">
  <p>
    Logged in as:
    <strong th:text="${#authentication.name}">username</strong>
  </p>

  <!-- Show name from OAuth2User if available, otherwise show authentication.name -->
  <p>
    Name:
    <span th:text="${#authentication.principal instanceof T(org.springframework.security.oauth2.core.user.OAuth2User)
                     ? #authentication.principal.getAttribute('name')
                     : #authentication.name}">name</span>
  </p>

  <!-- Show email if OAuth2User provides it -->
  <p th:if="${#authentication.principal instanceof T(org.springframework.security.oauth2.core.user.OAuth2User)
             and #authentication.principal.getAttribute('email') != null}">
    Email: <strong th:text="${#authentication.principal.getAttribute('email')}">email</strong>
  </p>

  <a href="#" onclick="event.preventDefault(); document.getElementById('logoutForm').submit();" style="color:red;">
    Logout
  </a>
  <form id="logoutForm" th:action="@{/logout}" method="post" style="display:none">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
  </form>

</div>

<div th:if="${#authentication == null}">
  <p>You are not logged in.</p>
  <a th:href="@{/login}">Login</a> |
  <a th:href="@{/register}">Register</a>
</div>

<hr>
<p><a th:href="@{/products}">Browse Products</a></p>
</body>
</html>
